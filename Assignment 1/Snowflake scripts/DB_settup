create database snowpipe_ingest_demo;
create role snowpipe_ingest_demo_sysadmin;
grant role snowpipe_ingest_demo_sysadmin to role sysadmin;

grant ownership on database snowpipe_ingest_demo to role snowpipe_ingest_demo_sysadmin;

use role snowpipe_ingest_demo_sysadmin;
create schema s3_ingest;

CREATE ROLE S3_INGEST_READONLY;
CREATE ROLE S3_INGEST_READWRITE;

GRANT USAGE ON DATABASE SNOWPIPE_INGEST_DEMO TO ROLE S3_INGEST_READONLY;
GRANT USAGE ON SCHEMA SNOWPIPE_INGEST_DEMO.S3_INGEST TO ROLE S3_INGEST_READONLY;
GRANT SELECT ON FUTURE TABLES IN SCHEMA SNOWPIPE_INGEST_DEMO.S3_INGEST TO ROLE S3_INGEST_READONLY;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA SNOWPIPE_INGEST_DEMO.S3_INGEST TO ROLE S3_INGEST_READONLY;

GRANT ROLE S3_INGEST_READONLY TO ROLE S3_INGEST_READWRITE;

GRANT USAGE ON DATABASE SNOWPIPE_INGEST_DEMO TO ROLE S3_INGEST_READWRITE;
GRANT USAGE ON SCHEMA SNOWPIPE_INGEST_DEMO.S3_INGEST TO ROLE S3_INGEST_READWRITE; 
GRANT ALL ON SCHEMA SNOWPIPE_INGEST_DEMO.S3_INGEST TO ROLE S3_INGEST_READWRITE;
