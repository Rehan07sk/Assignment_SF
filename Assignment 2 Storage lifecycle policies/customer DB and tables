
-- Create separate database for customer transactions
CREATE DATABASE CUSTOMER_TRANSACTIONS_DB;
USE DATABASE CUSTOMER_TRANSACTIONS_DB;

-- Create schemas for each customer
CREATE SCHEMA WALMART_SCHEMA;
CREATE SCHEMA AMAZON_SCHEMA;
CREATE SCHEMA TARGET_SCHEMA;

-- Create transaction tables in each schema
CREATE TABLE WALMART_SCHEMA.TRANSACTION (
    TRANSACTION_ID NUMBER,
    AMOUNT DECIMAL(10,2),
    CREATED_DATE TIMESTAMP_NTZ
);

CREATE TABLE AMAZON_SCHEMA.TRANSACTION (
    TRANSACTION_ID NUMBER,
    AMOUNT DECIMAL(10,2),
    CREATED_DATE TIMESTAMP_NTZ
);

CREATE TABLE TARGET_SCHEMA.TRANSACTION (
    TRANSACTION_ID NUMBER,
    AMOUNT DECIMAL(10,2),
    CREATED_DATE TIMESTAMP_NTZ
);

-- Insert sample data
INSERT INTO WALMART_SCHEMA.TRANSACTION VALUES
(1, 100.00, CURRENT_TIMESTAMP()),
(2, 200.00, DATEADD(day, -2, CURRENT_TIMESTAMP()));

INSERT INTO AMAZON_SCHEMA.TRANSACTION VALUES
(1, 300.00, CURRENT_TIMESTAMP()),
(2, 400.00, DATEADD(day, -3, CURRENT_TIMESTAMP()));

INSERT INTO TARGET_SCHEMA.TRANSACTION VALUES
(1, 500.00, CURRENT_TIMESTAMP()),
(2, 600.00, DATEADD(day, -4, CURRENT_TIMESTAMP()));
